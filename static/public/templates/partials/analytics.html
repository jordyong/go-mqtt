{{ define "analytics"}}
<div class="flex gap-4 w-full text-gray-300">
  <div class="w-2/3 flex-grow rounded-xl">
    <div id="map" class="h-full rounded-xl"></div>
  </div>

  <div class="flex flex-col gap-4 w-1/3">
    <div class="rounded-xl bg-gray-800 flex flex-col">
      <header class="border-b p-4 border-gray-500">
        <h3 class="font-bold text-xl">Swarm</h3>
      </header>
      <div class="">
        <canvas id="" class=""></canvas>
      </div>
    </div>
    <div class="flex-grow rounded-xl bg-gray-800 flex flex-col">
      <header class="border-b p-4 border-gray-500">
        <h3 class="font-bold text-xl">Harvested Energy (W)</h3>
      </header>
      <div class="h-full">
        <canvas id="collectedEnergy" class=""></canvas>
      </div>
    </div>
  </div>

<!--For Leaflet.js-->
<script>
if (map != undefined) {
map.remove();
}
var map = L.map("map").setView([1.300150, 103.78075], 18);
L.tileLayer("https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}.png", {
maxZoom: 25,
attribution:
'&copy; <a href="http://www.openstreetmap.org/copyright>OpenStreeMap</a>',
}).addTo(map);
ext : 'png'

htmx.onLoad(function () {
Chart.getChart("collectedEnergy")?.destroy();
const ctx = document.getElementById("collectedEnergy");
const myChart = new Chart(ctx, {
type: "line",
data: {
datasets: [
{
fill: false,
borderColor: "rgb(75, 192, 192)",
tension: 0.1,
},
],
},
options: {
layout: {
padding: 20,
},
scales: {
y: {
border: {
display: false,
},
grid: {
color: "rgb(107, 114, 128)",
},
suggestedMin: 0,
suggestedMax: 120,
ticks: {
maxTicksLimit: 8,
},
},
x: {
type: "time",
time: {
unit: "hour",
displayFormats: {
hour: "h:mm a",
},
},
border: {
display: false,
},
grid: {
display: false,
},
suggestedMin: new Date().setHours(0, 0, 0, 0),
suggestedMax: new Date().setHours(23, 59, 59, 999),
},
},
plugins: {
legend: {
display: false,
},
},
responsive: true,
maintainAspectRatio: false,
},
});
});
</script>
</div>
{{ end }}
